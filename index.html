<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>Ù…ÙˆØ§Ù‚ÙŠØª Ø§Ù„ØµÙ„Ø§Ø©</title>

  <!-- iOS Home Screen support -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #f7f7f7;
      text-align: center;
      padding: 20px;
    }

    /* ðŸ”¹ TITLE SIZE */
    h1 {
      font-size: 42px; /* BIGGER */
      margin-bottom: 25px;
    }

    /* ðŸ”¹ COUNTDOWN TEXT */
    .next {
      font-size: 34px; /* BIGGER */
      font-weight: bold;
      margin-bottom: 35px;
      color: #1f5f3b;
    }

    /* ðŸ”¹ PRAYER TIMES TEXT */
    .time {
      font-size: 36px; /* BIGGER */
      margin: 20px 0;
    }
  </style>
</head>
<body>

  <h1>ðŸ•Œ Ù…ÙˆØ§Ù‚ÙŠØª Ø§Ù„ØµÙ„Ø§Ø©</h1>
  <div id="next" class="next">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­Ø³Ø§Ø¨â€¦</div>
  <div id="times">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„â€¦</div>

  <script>
    // ðŸ”¢ Convert English numbers to Arabic numerals
    function toArabicNumbers(text) {
      const arabicNums = ['Ù ','Ù¡','Ù¢','Ù£','Ù¤','Ù¥','Ù¦','Ù§','Ù¨','Ù©'];
      return text.replace(/\d/g, d => arabicNums[d]);
    }
    function formatTime12h(time24) {
      let [h, m] = time24.split(":").map(Number);
    
      // Convert 24h â†’ 12h
      h = h % 12;
      if (h === 0) h = 12;
    
      const formatted = `${h}:${m.toString().padStart(2, "0")}`;
      return toArabicNumbers(formatted);
    }

    function loadPrayerTimes() {
      fetch("https://api.aladhan.com/v1/timingsByCity?city=Istanbul&country=Turkey&method=13")
        .then(res => res.json())
        .then(data => {
          const t = data.data.timings;

          const prayers = [
            { name: "Ø§Ù„ÙØ¬Ø±", time: t.Fajr },
            { name: "Ø§Ù„Ø´Ø±ÙˆÙ‚", time: t.Sunrise }, // ðŸŒ… ADDED
            { name: "Ø§Ù„Ø¸Ù‡Ø±", time: t.Dhuhr },
            { name: "Ø§Ù„Ø¹ØµØ±", time: t.Asr },
            { name: "Ø§Ù„Ù…ØºØ±Ø¨", time: t.Maghrib },
            { name: "Ø§Ù„Ø¹Ø´Ø§Ø¡", time: t.Isha }
          ];

          // Show prayer times
          document.getElementById("times").innerHTML = prayers
            .map(p => `<div class="time">${p.name}: ${formatTime12h(p.time)}</div>`)
            .join("");

          const now = new Date();
          let nextPrayer = null;

          for (const p of prayers) {
            const [h, m] = p.time.split(":");
            const prayerTime = new Date();
            prayerTime.setHours(h, m, 0, 0);

            if (prayerTime > now) {
              nextPrayer = { name: p.name, time: prayerTime };
              break;
            }
          }

          if (!nextPrayer) {
            const [h, m] = prayers[0].time.split(":");
            const prayerTime = new Date();
            prayerTime.setDate(prayerTime.getDate() + 1);
            prayerTime.setHours(h, m, 0, 0);
            nextPrayer = { name: prayers[0].name, time: prayerTime };
          }

          const diffMin = Math.floor((nextPrayer.time - now) / 60000);
          const hours = Math.floor(diffMin / 60);
          const minutes = diffMin % 60;

          let timeText = "";
          if (hours > 0 && minutes > 0) {
            timeText = `${hours} Ø³Ø§Ø¹Ø© Ùˆ ${minutes} Ø¯Ù‚ÙŠÙ‚Ø©`;
          } else if (hours > 0) {
            timeText = `${hours} Ø³Ø§Ø¹Ø©`;
          } else {
            timeText = `${minutes} Ø¯Ù‚ÙŠÙ‚Ø©`;
          }

          document.getElementById("next").innerText =
            toArabicNumbers(`Ø¨Ø§Ù‚ÙŠ ${timeText} Ø¹Ù„Ù‰ ØµÙ„Ø§Ø© ${nextPrayer.name}`);
        });
    }

    // Initial load
    loadPrayerTimes();

    // ðŸ” iOS Home Screen refresh fix
    document.addEventListener("visibilitychange", () => {
      if (!document.hidden) {
        loadPrayerTimes();
      }
    });

    window.addEventListener("focus", loadPrayerTimes);
  </script>

</body>
</html>
